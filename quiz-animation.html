<link rel="import" href="../polymer/polymer-element.html">

<script>

  const AnimationMixin = superclass => class extends superclass {

    static get properties() {
      return {
        exitHorizontal: {
          type: Array,
          value: () => [
            {transform: 'translateX(0)', opacity: 1},
            {transform: 'translateX(100%)', opacity: 0}
          ]
        },
        enterHorizontal: {
          type: Array,
          value: () => [
            {transform: 'translateX(100%)', opacity: 0},
            {transform: 'translateX(0)', opacity: 1}
          ]
        },
        exitVertical: {
          type: Array,
          value: () => [
            {transform: 'translateY(0)', opacity: 1},
            {transform: 'translateY(20px)', opacity: 0}
          ]
        },
        enterVertical: {
          type: Array,
          value: () => [
            {transform: 'translateY(20px)', opacity: 0},
            {transform: 'translateY(0)', opacity: 1}
          ]
        },
        easePower2: {
          type: String,
          value: 'cubic-bezier(0.4, 0, 0.2, 1)'
        },
        easeBack: {
          type: String,
          value: 'cubic-bezier(0.175, 0.885, 0.32, 1.275)'
        },
        baseDuration: {
          type: Number,
          value: 300
        }
      };
    }

    connectedCallback() {
      super.connectedCallback();
    }

    _quizTransitionAnimation() {
      this.$.questionText.animate(this.exitHorizontal, {
        delay: 500,
        duration: 600,
        easing: this.easePower2,
        fill: 'both'
      });

      this.currentQuestionChoices.map( (element, index) => {
        this.exitAnim = element.animate(this.exitHorizontal, {
          delay: 575 + (index * 100),
          duration: this.baseDuration,
          easing: this.easePower2,
          fill: 'both'
        });
      });

      this.exitAnim.onfinish = () => {
        this.currentQuestion++;
        this.currentQuestionChoices = null;

        this._revealQuestionAnimation();
        this._revealAnswersAnimation();
      };
    }

    _revealQuestionAnimation() {
      this.$.questionText.animate(this.enterVertical, {
        delay: 250,
        duration: this.baseDuration,
        easing: this.easePower2,
        fill: 'both'
      });
    }

    _revealAnswersAnimation() {

      this.currentQuestionChoices = Array.prototype.slice.call(
        this.shadowRoot.querySelectorAll('.question-choices')
      );

      this.currentQuestionChoices.map( (element, index) => {
        element.animate(this.enterVertical, {
          delay: 375 + (index * 100),
          duration: this.baseDuration,
          easing: this.easePower2,
          fill: 'both'
        });
      });
    }

    _revealScoreAnimation() {
      this.$.quizScore.animate([
        {transform: 'translateX(-50px)', opacity: 0},
        {transform: 'translateX(0)', opacity: 1}
      ], {
        duration: this.baseDuration,
        easing: this.easeBack,
        fill: 'both'
      });
    }

    _revealResetBtnAnimation() {
      this.$.resetBtn.animate([
        {transform: 'scale(0.45)', opacity: 0},
        {transform: 'scale(1)', opacity: 1}
      ], {
        delay: 450,
        duration: this.baseDuration,
        easing: this.easeBack,
        fill: 'both'
      });
    }

  };

</script>
